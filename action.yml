name: PolyglotRocks
description: "This action automates Xcode project localization using the PolyglotRocks tool for efficient and automated translations in your CI/CD pipeline."

inputs:
  path:
    description: "The path to the Xcode project directory to be localized (relative to the root of the repository)."
    required: true
  token:
    description: "The API token provided by PolyglotRocks."
    required: true
  bundle_id:
    description: "The product bundle identifier of the Xcode project."
    required: true
  api_url:
    description: "The URL of the API endpoint to use for localization."
    required: false
    default: "https://api.dev.polyglot.rocks"

runs:
  using: "composite"
  steps:
    - uses: actions/checkout@v2
    - name: pull image
      run: docker pull ghcr.io/clickcaramel/polyglot-rocks:0.1.5
      shell: bash
    - name: run polyglot
      run: |
        docker run --rm \
          --env "TOKEN=${{ inputs.token }}" \
          --env "PRODUCT_BUNDLE_IDENTIFIER=${{ inputs.bundle_id}}" \
          --env "API_URL=${{ inputs.api_url }}" \
          --volume "$(pwd)/${{ inputs.path }}:/home/polyglot/target" \
          ghcr.io/clickcaramel/polyglot-rocks:0.1.5
      shell: bash
